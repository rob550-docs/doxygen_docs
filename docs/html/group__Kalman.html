<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MBot Software Library: Kalman</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MBot Software Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Kalman</div>  </div>
</div><!--header-->
<div class="contents">

<p>Kalman filter implementation.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga0da30f3b8e8ab0e1b5107153a7587b93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#ga0da30f3b8e8ab0e1b5107153a7587b93">RC_KALMAN_INITIALIZER</a></td></tr>
<tr class="separator:ga0da30f3b8e8ab0e1b5107153a7587b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga017973a86246a2d4010769032eb4c487"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#ga017973a86246a2d4010769032eb4c487">rc_kalman_t</a></td></tr>
<tr class="separator:ga017973a86246a2d4010769032eb4c487"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga80ea8020dd1c094fd8c68d1e113635e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#ga80ea8020dd1c094fd8c68d1e113635e2">rc_kalman_empty</a> (void)</td></tr>
<tr class="memdesc:ga80ea8020dd1c094fd8c68d1e113635e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Critical function for initializing <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> structs.  <a href="group__Kalman.html#ga80ea8020dd1c094fd8c68d1e113635e2">More...</a><br /></td></tr>
<tr class="separator:ga80ea8020dd1c094fd8c68d1e113635e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef5414ac19de6879ebc973080ef9937e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#gaef5414ac19de6879ebc973080ef9937e">rc_kalman_alloc_lin</a> (<a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *kf, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> F, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> G, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> H, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> Q, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> R, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> Pi)</td></tr>
<tr class="memdesc:gaef5414ac19de6879ebc973080ef9937e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory for a Kalman filter of given dimensions.  <a href="group__Kalman.html#gaef5414ac19de6879ebc973080ef9937e">More...</a><br /></td></tr>
<tr class="separator:gaef5414ac19de6879ebc973080ef9937e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa1396714a36d70df657215770a947f41"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#gaa1396714a36d70df657215770a947f41">rc_kalman_alloc_ekf</a> (<a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *kf, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> Q, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> R, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> Pi)</td></tr>
<tr class="memdesc:gaa1396714a36d70df657215770a947f41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates memory for a Kalman filter of given dimensions.  <a href="group__Kalman.html#gaa1396714a36d70df657215770a947f41">More...</a><br /></td></tr>
<tr class="separator:gaa1396714a36d70df657215770a947f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab6cb032f310a746c267f40b5943f0a78"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#gab6cb032f310a746c267f40b5943f0a78">rc_kalman_free</a> (<a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *kf)</td></tr>
<tr class="memdesc:gab6cb032f310a746c267f40b5943f0a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees the memory allocated by a kalman filter's matrices and vectors. Also resets all values to 0 like <a class="el" href="group__Kalman.html#ga80ea8020dd1c094fd8c68d1e113635e2" title="Critical function for initializing rc_kalman_t structs.">rc_kalman_empty()</a>.  <a href="group__Kalman.html#gab6cb032f310a746c267f40b5943f0a78">More...</a><br /></td></tr>
<tr class="separator:gab6cb032f310a746c267f40b5943f0a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19b1abb2679b0d44ec9b49d07ada3b7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#ga19b1abb2679b0d44ec9b49d07ada3b7b">rc_kalman_reset</a> (<a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *kf)</td></tr>
<tr class="memdesc:ga19b1abb2679b0d44ec9b49d07ada3b7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">reset state and dynamics of the filter to 0  <a href="group__Kalman.html#ga19b1abb2679b0d44ec9b49d07ada3b7b">More...</a><br /></td></tr>
<tr class="separator:ga19b1abb2679b0d44ec9b49d07ada3b7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf96115115c3ce643cc4bbd4e86af423d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#gaf96115115c3ce643cc4bbd4e86af423d">rc_kalman_update_lin</a> (<a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *kf, <a class="el" href="structrc__vector__t.html">rc_vector_t</a> u, <a class="el" href="structrc__vector__t.html">rc_vector_t</a> y)</td></tr>
<tr class="memdesc:gaf96115115c3ce643cc4bbd4e86af423d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kalman Filter state prediction step based on physical model.  <a href="group__Kalman.html#gaf96115115c3ce643cc4bbd4e86af423d">More...</a><br /></td></tr>
<tr class="separator:gaf96115115c3ce643cc4bbd4e86af423d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa4f40b5e155334765875814996558ebd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Kalman.html#gaa4f40b5e155334765875814996558ebd">rc_kalman_update_ekf</a> (<a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *kf, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> F, <a class="el" href="structrc__matrix__t.html">rc_matrix_t</a> H, <a class="el" href="structrc__vector__t.html">rc_vector_t</a> x_pre, <a class="el" href="structrc__vector__t.html">rc_vector_t</a> y, <a class="el" href="structrc__vector__t.html">rc_vector_t</a> h)</td></tr>
<tr class="memdesc:gaa4f40b5e155334765875814996558ebd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kalman Filter measurement update step.  <a href="group__Kalman.html#gaa4f40b5e155334765875814996558ebd">More...</a><br /></td></tr>
<tr class="separator:gaa4f40b5e155334765875814996558ebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Kalman filter implementation. </p>
<p>&lt;<a class="el" href="kalman_8h.html">rc/math/kalman.h</a>&gt;</p>
<p>This may be used to implement a discrete time linear or extended kalman filter.</p>
<p>For the linear case, initialize the filter with <a class="el" href="group__Kalman.html#gaef5414ac19de6879ebc973080ef9937e" title="Allocates memory for a Kalman filter of given dimensions.">rc_kalman_alloc_lin()</a> which takes in the linear state matrices. These are then saved and used by rc_kalman_update_lin to calculate the predicted state x_pre and predicted sensor measurements h internally each step.</p>
<p>Basic loop structure for Linear case:</p>
<div class="fragment"><div class="line"><a class="code" href="structrc__kalman__t.html">rc_kalman_t</a> kf = <a class="code" href="group__Kalman.html#ga80ea8020dd1c094fd8c68d1e113635e2">rc_kalman_empty</a>();</div>
<div class="line"><a class="code" href="group__Kalman.html#gaef5414ac19de6879ebc973080ef9937e">rc_kalman_alloc_lin</a>(&amp;kf,F,G,H,Q,R,Pi);</div>
<div class="line"><span class="keywordflow">while</span>(<a class="code" href="namespacembot__test__drive.html#ae0960295307fcb603f447fd8db0a53cb">running</a>){</div>
<div class="line">     measure sensors, calculate y;</div>
<div class="line">     <a class="code" href="group__Kalman.html#gaf96115115c3ce643cc4bbd4e86af423d">rc_kalman_update_lin</a>(&amp;kf, u, y);</div>
<div class="line">     calculate <span class="keyword">new</span> actuator control output u;</div>
<div class="line">     save u <span class="keywordflow">for</span> next loop;</div>
<div class="line">}</div>
<div class="line"><a class="code" href="group__Kalman.html#gab6cb032f310a746c267f40b5943f0a78">rc_kalman_free</a>(&amp;kf);</div>
<div class="line"><span class="keywordflow">return</span>;</div>
<div class="ttc" id="agroup__Kalman_html_ga80ea8020dd1c094fd8c68d1e113635e2"><div class="ttname"><a href="group__Kalman.html#ga80ea8020dd1c094fd8c68d1e113635e2">rc_kalman_empty</a></div><div class="ttdeci">rc_kalman_t rc_kalman_empty(void)</div><div class="ttdoc">Critical function for initializing rc_kalman_t structs.</div><div class="ttdef"><b>Definition:</b> kalman.c:14</div></div>
<div class="ttc" id="agroup__Kalman_html_gab6cb032f310a746c267f40b5943f0a78"><div class="ttname"><a href="group__Kalman.html#gab6cb032f310a746c267f40b5943f0a78">rc_kalman_free</a></div><div class="ttdeci">int rc_kalman_free(rc_kalman_t *kf)</div><div class="ttdoc">Frees the memory allocated by a kalman filter's matrices and vectors. Also resets all values to 0 lik...</div><div class="ttdef"><b>Definition:</b> kalman.c:115</div></div>
<div class="ttc" id="agroup__Kalman_html_gaef5414ac19de6879ebc973080ef9937e"><div class="ttname"><a href="group__Kalman.html#gaef5414ac19de6879ebc973080ef9937e">rc_kalman_alloc_lin</a></div><div class="ttdeci">int rc_kalman_alloc_lin(rc_kalman_t *kf, rc_matrix_t F, rc_matrix_t G, rc_matrix_t H, rc_matrix_t Q, rc_matrix_t R, rc_matrix_t Pi)</div><div class="ttdoc">Allocates memory for a Kalman filter of given dimensions.</div><div class="ttdef"><b>Definition:</b> kalman.c:21</div></div>
<div class="ttc" id="agroup__Kalman_html_gaf96115115c3ce643cc4bbd4e86af423d"><div class="ttname"><a href="group__Kalman.html#gaf96115115c3ce643cc4bbd4e86af423d">rc_kalman_update_lin</a></div><div class="ttdeci">int rc_kalman_update_lin(rc_kalman_t *kf, rc_vector_t u, rc_vector_t y)</div><div class="ttdoc">Kalman Filter state prediction step based on physical model.</div><div class="ttdef"><b>Definition:</b> kalman.c:159</div></div>
<div class="ttc" id="anamespacembot__test__drive_html_ae0960295307fcb603f447fd8db0a53cb"><div class="ttname"><a href="namespacembot__test__drive.html#ae0960295307fcb603f447fd8db0a53cb">mbot_test_drive.running</a></div><div class="ttdeci">bool running</div><div class="ttdef"><b>Definition:</b> mbot_test_drive.py:19</div></div>
<div class="ttc" id="astructrc__kalman__t_html"><div class="ttname"><a href="structrc__kalman__t.html">rc_kalman_t</a></div><div class="ttdef"><b>Definition:</b> kalman.h:82</div></div>
</div><!-- fragment --><p>For the non-linear EKF case, the user should initialize the filter with <a class="el" href="group__Kalman.html#gaa1396714a36d70df657215770a947f41" title="Allocates memory for a Kalman filter of given dimensions.">rc_kalman_alloc_ekf()</a> which does NOT take in the state transition matrices F,G,H. Instead it's up to the user to calculate the new predicted state x_pre and predicted sensor measurement h for their own non-linear system model each step. Those user-calculated predictions are then given to the non-linear <a class="el" href="group__Kalman.html#gaa4f40b5e155334765875814996558ebd" title="Kalman Filter measurement update step.">rc_kalman_update_ekf()</a> function.</p>
<p>Basic loop structure for non-linear EKF case:</p>
<div class="fragment"><div class="line"><a class="code" href="structrc__kalman__t.html">rc_kalman_t</a> kf = <a class="code" href="group__Kalman.html#ga80ea8020dd1c094fd8c68d1e113635e2">rc_kalman_empty</a>();</div>
<div class="line"><a class="code" href="group__Kalman.html#gaa1396714a36d70df657215770a947f41">rc_kalman_alloc_ekf</a>(&amp;kf,Q,R,Pi);</div>
<div class="line"><span class="keywordflow">while</span>(<a class="code" href="namespacembot__test__drive.html#ae0960295307fcb603f447fd8db0a53cb">running</a>){</div>
<div class="line">     measure sensors, calculate y</div>
<div class="line">     calculate <span class="keyword">new</span> Jacobian F given x_est from previous loop;</div>
<div class="line">     calculate <span class="keyword">new</span> predicted x_pre <span class="keyword">using</span> x_est from previous</div>
<div class="line">     loop;</div>
<div class="line">     calulate <span class="keyword">new</span> predicted sensor readings h from x_pre above;</div>
<div class="line">     calculate <span class="keyword">new</span> Jacobian H given x_pre;</div>
<div class="line">     <a class="code" href="group__Kalman.html#gaa4f40b5e155334765875814996558ebd">rc_kalman_update_ekf</a>(&amp;kf, F, x_pre, H, y, h);</div>
<div class="line">     calculate <span class="keyword">new</span> actuator control output u;</div>
<div class="line">     save u <span class="keywordflow">for</span> next loop;</div>
<div class="line">}</div>
<div class="line"><a class="code" href="group__Kalman.html#gab6cb032f310a746c267f40b5943f0a78">rc_kalman_free</a>(&amp;kf);</div>
<div class="line"><span class="keywordflow">return</span>;</div>
<div class="ttc" id="agroup__Kalman_html_gaa1396714a36d70df657215770a947f41"><div class="ttname"><a href="group__Kalman.html#gaa1396714a36d70df657215770a947f41">rc_kalman_alloc_ekf</a></div><div class="ttdeci">int rc_kalman_alloc_ekf(rc_kalman_t *kf, rc_matrix_t Q, rc_matrix_t R, rc_matrix_t Pi)</div><div class="ttdoc">Allocates memory for a Kalman filter of given dimensions.</div><div class="ttdef"><b>Definition:</b> kalman.c:80</div></div>
<div class="ttc" id="agroup__Kalman_html_gaa4f40b5e155334765875814996558ebd"><div class="ttname"><a href="group__Kalman.html#gaa4f40b5e155334765875814996558ebd">rc_kalman_update_ekf</a></div><div class="ttdeci">int rc_kalman_update_ekf(rc_kalman_t *kf, rc_matrix_t F, rc_matrix_t H, rc_vector_t x_pre, rc_vector_t y, rc_vector_t h)</div><div class="ttdoc">Kalman Filter measurement update step.</div><div class="ttdef"><b>Definition:</b> kalman.c:250</div></div>
</div><!-- fragment --><dl class="section date"><dt>Date</dt><dd>April 2018 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Eric Nauli Sihite &amp; James Strawson </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga0da30f3b8e8ab0e1b5107153a7587b93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0da30f3b8e8ab0e1b5107153a7587b93">&#9670;&nbsp;</a></span>RC_KALMAN_INITIALIZER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RC_KALMAN_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {\</div>
<div class="line">    .F = <a class="code" href="group__Matrix.html#ga1fe4da792f1d95eb45f773a26b7c40d7">RC_MATRIX_INITIALIZER</a>,\</div>
<div class="line">    .G = <a class="code" href="group__Matrix.html#ga1fe4da792f1d95eb45f773a26b7c40d7">RC_MATRIX_INITIALIZER</a>,\</div>
<div class="line">    .H = <a class="code" href="group__Matrix.html#ga1fe4da792f1d95eb45f773a26b7c40d7">RC_MATRIX_INITIALIZER</a>,\</div>
<div class="line">    .Q = <a class="code" href="group__Matrix.html#ga1fe4da792f1d95eb45f773a26b7c40d7">RC_MATRIX_INITIALIZER</a>,\</div>
<div class="line">    .R = <a class="code" href="group__Matrix.html#ga1fe4da792f1d95eb45f773a26b7c40d7">RC_MATRIX_INITIALIZER</a>,\</div>
<div class="line">    .P = <a class="code" href="group__Matrix.html#ga1fe4da792f1d95eb45f773a26b7c40d7">RC_MATRIX_INITIALIZER</a>,\</div>
<div class="line">    .Pi = <a class="code" href="group__Matrix.html#ga1fe4da792f1d95eb45f773a26b7c40d7">RC_MATRIX_INITIALIZER</a>,\</div>
<div class="line">    .x_est = <a class="code" href="group__Vector.html#gab72eb22064075a2bc691904c5a6f64a4">RC_VECTOR_INITIALIZER</a>,\</div>
<div class="line">    .x_pre = <a class="code" href="group__Vector.html#gab72eb22064075a2bc691904c5a6f64a4">RC_VECTOR_INITIALIZER</a>,\</div>
<div class="line">    .initialized = 0,\</div>
<div class="line">    .step = 0}</div>
<div class="ttc" id="agroup__Matrix_html_ga1fe4da792f1d95eb45f773a26b7c40d7"><div class="ttname"><a href="group__Matrix.html#ga1fe4da792f1d95eb45f773a26b7c40d7">RC_MATRIX_INITIALIZER</a></div><div class="ttdeci">#define RC_MATRIX_INITIALIZER</div><div class="ttdef"><b>Definition:</b> matrix.h:39</div></div>
<div class="ttc" id="agroup__Vector_html_gab72eb22064075a2bc691904c5a6f64a4"><div class="ttname"><a href="group__Vector.html#gab72eb22064075a2bc691904c5a6f64a4">RC_VECTOR_INITIALIZER</a></div><div class="ttdeci">#define RC_VECTOR_INITIALIZER</div><div class="ttdef"><b>Definition:</b> vector.h:48</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga017973a86246a2d4010769032eb4c487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga017973a86246a2d4010769032eb4c487">&#9670;&nbsp;</a></span>rc_kalman_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaa1396714a36d70df657215770a947f41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa1396714a36d70df657215770a947f41">&#9670;&nbsp;</a></span>rc_kalman_alloc_ekf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rc_kalman_alloc_ekf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *&#160;</td>
          <td class="paramname"><em>kf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>Pi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates memory for a Kalman filter of given dimensions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">kf</td><td>pointer to struct to be allocated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Q</td><td>Process noise covariance, can be updated later </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R</td><td>Measurement noise covariance, can be updated later </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Pi</td><td>Initial P matrix</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

</div>
</div>
<a id="gaef5414ac19de6879ebc973080ef9937e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef5414ac19de6879ebc973080ef9937e">&#9670;&nbsp;</a></span>rc_kalman_alloc_lin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rc_kalman_alloc_lin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *&#160;</td>
          <td class="paramname"><em>kf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>Pi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates memory for a Kalman filter of given dimensions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">kf</td><td>pointer to struct to be allocated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">F</td><td>undriven state-transition model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">G</td><td>control input model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">H</td><td>observation model </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Q</td><td>Process noise covariance, can be updated later </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">R</td><td>Measurement noise covariance, can be updated later </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Pi</td><td>Initial P matrix</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

</div>
</div>
<a id="ga80ea8020dd1c094fd8c68d1e113635e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga80ea8020dd1c094fd8c68d1e113635e2">&#9670;&nbsp;</a></span>rc_kalman_empty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> rc_kalman_empty </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Critical function for initializing <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> structs. </p>
<p>This is a very important function. If your <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> struct is not a global variable, then its initial contents cannot be guaranteed to be anything in particular. Therefore it could contain problematic contents which could interfere with functions in this library. Therefore, you should always initialize your filters with <a class="el" href="group__Kalman.html#ga80ea8020dd1c094fd8c68d1e113635e2" title="Critical function for initializing rc_kalman_t structs.">rc_kalman_empty()</a> before using with any other function in this library such as rc_kalman_alloc. This serves the same purpose as rc_matrix_empty, rc_vector_empty, rc_filter_empty, and rc_ringbuf_empty.</p>
<dl class="section return"><dt>Returns</dt><dd>Empty zero-filled <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> struct </dd></dl>

</div>
</div>
<a id="gab6cb032f310a746c267f40b5943f0a78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab6cb032f310a746c267f40b5943f0a78">&#9670;&nbsp;</a></span>rc_kalman_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rc_kalman_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *&#160;</td>
          <td class="paramname"><em>kf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees the memory allocated by a kalman filter's matrices and vectors. Also resets all values to 0 like <a class="el" href="group__Kalman.html#ga80ea8020dd1c094fd8c68d1e113635e2" title="Critical function for initializing rc_kalman_t structs.">rc_kalman_empty()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kf</td><td>pointer to user's <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success or -1 on failure. </dd></dl>

</div>
</div>
<a id="ga19b1abb2679b0d44ec9b49d07ada3b7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga19b1abb2679b0d44ec9b49d07ada3b7b">&#9670;&nbsp;</a></span>rc_kalman_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rc_kalman_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *&#160;</td>
          <td class="paramname"><em>kf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reset state and dynamics of the filter to 0 </p>
<p>Q and R are constant, and therefore not reset. P is set to identity*P_init.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">kf</td><td>pointer to struct to be reset</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

</div>
</div>
<a id="gaa4f40b5e155334765875814996558ebd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa4f40b5e155334765875814996558ebd">&#9670;&nbsp;</a></span>rc_kalman_update_ekf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rc_kalman_update_ekf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *&#160;</td>
          <td class="paramname"><em>kf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__matrix__t.html">rc_matrix_t</a>&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__vector__t.html">rc_vector_t</a>&#160;</td>
          <td class="paramname"><em>x_pre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__vector__t.html">rc_vector_t</a>&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__vector__t.html">rc_vector_t</a>&#160;</td>
          <td class="paramname"><em>h</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kalman Filter measurement update step. </p>
<p>Updates L, P, &amp; x_est. Assumes that you have done the non-linear prediction step in your own function which should calculate the Jacobians F(x[k|k-1]) &amp; H(x[k|k-1]), the predicted sensor value h(x[k|k-1]), and of course the predicted state x_pre[k|k-1]</p>
<p>-Kalman measurement Update:</p><ul>
<li>P[k|k-1] = F*P[k-1|k-1]*F^T + Q</li>
<li>S = H*P*H^T + R</li>
<li>L = P*(H^T)*(S^-1)</li>
<li>x[k|k] = x[k|k-1] + L*y</li>
<li>P[k|k] = (I - L*H)*P</li>
</ul>
<p>Also updates the step counter in the <a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> struct</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">kf</td><td>pointer to struct to be updated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">F</td><td>Jacobian of state transition matrix linearized at x_pre </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">H</td><td>Jacobian of observation matrix linearized at x_pre </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x_pre</td><td>predicted state </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>new sensor data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>Ideal estimate of y, usually h=H*x_pre.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

</div>
</div>
<a id="gaf96115115c3ce643cc4bbd4e86af423d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf96115115c3ce643cc4bbd4e86af423d">&#9670;&nbsp;</a></span>rc_kalman_update_lin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rc_kalman_update_lin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structrc__kalman__t.html">rc_kalman_t</a> *&#160;</td>
          <td class="paramname"><em>kf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__vector__t.html">rc_vector_t</a>&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structrc__vector__t.html">rc_vector_t</a>&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kalman Filter state prediction step based on physical model. </p>
<p>Uses the state estimate and control input from the previous timestep to produce an estimate of the state at the current timestep. This step pdates P and the estimated state x. Assume that you have calculated f(x[k|k],u[k]) and F(x[k|k],u[k]) before calling this function.</p>
<ul>
<li>Kalman linear state prediction<ul>
<li>x_pre[k|k-1] = F*x[k-1|k-1] + G*u[k-1]</li>
<li>P[k|k-1] = F*P[k-1|k-1]*F^T + Q</li>
</ul>
</li>
<li>Kalman measurement Update:<ul>
<li>h[k] = H * x_pre[k]</li>
<li>S = H*P*H^T + R</li>
<li>L = P*(H^T)*(S^-1)</li>
<li>x_est[k|k] = x[k|k-1] + L*(y[k]-h[k])</li>
<li>P[k|k] = (I - L*H)*P[k|k-1]</li>
</ul>
</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">kf</td><td>pointer to struct to be updated </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">u</td><td>control input </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">y</td><td>sensor measurement</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
